我将优化同步流程，将耗时的 I/O 操作移至后台，并分批处理数据库更新，以彻底解决界面卡死问题。

1.  **修改 `FolderSyncService.swift`**:
    *   保留现有的后台文件扫描逻辑。
    *   **I/O 操作后台化**: 将最耗时的“新文件 Bookmark 生成”操作 (`url.bookmarkData`) 移至后台线程（Detached Task）并行处理。这是导致当前 UI 卡死的主要原因。
    *   **数据库操作分批执行**: 虽然 SwiftData 的写入需要在主线程进行，但我会将其分批处理（例如每 50-100 个文件一组），并在批次之间调用 `Task.yield()` 让出主线程控制权，确保 UI 能够及时刷新响应。
    *   **进度反馈优化**: 更新进度计算逻辑，使其能准确反映后台处理和写入的进度。

2.  **具体实现细节**:
    *   使用 `Task.detached` 或 `nonisolated` 辅助方法在后台预先生成所有新增文件的 Bookmark 数据。
    *   在主线程的数据库插入和删除循环中加入 `Task.yield()`，防止长时间占用主运行循环。

这个方案能在不破坏现有架构的前提下，最大限度地利用后台线程，保证同步过程流畅无感。