## 现状与问题定位
- 左侧“文件夹”当前只展示目录树，未展示具体文件：在 ContentView 中使用 FolderNode.buildTree(from: photos) 构建树，仅生成目录节点。[ContentView.swift:sidebarColumn](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/ContentView.swift#L171-L209)
- 已具备生成“包含文件项”的能力：FolderNode.buildTreeWithFiles(from:) 会在每个目录下追加文件节点（isFile=true）。[FolderNode.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Models/FolderNode.swift#L51-L93)
- SidebarView 的行渲染未区分“文件/文件夹”，点击行为一律按目录处理。[SidebarView.swift:foldersSection](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/SidebarView.swift#L194-L248)

## 方案概述
- 增加“显示文件”开关（@AppStorage("showFilesInSidebar")）用于控制侧栏是否展示具体文件。
- 当开关开启时，改用 FolderNode.buildTreeWithFiles(from:) 构建数据源；关闭时维持现状。
- SidebarView 对节点类型分支渲染：
  - 文件夹节点沿用现有行为与菜单；
  - 文件节点使用“文档/照片”图标，不显示计数；点击直接选中并进入单张视图。
- 在“设置-通用”页和侧栏“文件夹”区头部都提供该开关入口，保持一致的控制路径。

## 详细改动
### 数据模型
- 复用现有 FolderNode.buildTreeWithFiles；不修改模型结构。[FolderNode.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Models/FolderNode.swift)

### ContentView
- 新增 @AppStorage("showFilesInSidebar") 以读取开关状态。
- 在 sidebarColumn 中根据开关选择构建器：
  - 开启：FolderNode.buildTreeWithFiles(from: photos)
  - 关闭：FolderNode.buildTree(from: photos)
- 新增文件选择与文件操作回调并传给 SidebarView：
  - onSelectFile(Photo): 设置 currentPhoto、selectedPhotos，并将 viewMode 置为 .single；
  - onRevealFile(Photo): NSWorkspace 选中文件；
  - onDeletePhotoFromLibrary(Photo): 从模型中移除该 Photo；
  - onDeletePhotoFromDisk(Photo): 删除磁盘文件并移除模型。
- 代码位置与上下文：[ContentView.swift:sidebarColumn](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/ContentView.swift#L171-L209)、[ContentView.swift:singleViewer](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/ContentView.swift#L270-L288)

### SidebarView
- 新增 @AppStorage("showFilesInSidebar") 使侧栏头部可直接切换该开关。
- 扩展初始化参数以接收新回调：onSelectFile、onRevealFile、onDeletePhotoFromLibrary、onDeletePhotoFromDisk。
- 在 OutlineGroup 行渲染中分支：
  - if node.isFile：使用 doc.fill 或 photo 图标；标题为文件名；点击调用 onSelectFile(node.photo!)；不显示计数；
  - else：维持现有目录行与计数；
- 文件节点的右键菜单：
  - 查看照片（调用 onSelectFile）；在 Finder 中显示（onRevealFile）；从库移除（onDeletePhotoFromLibrary）；从磁盘删除（onDeletePhotoFromDisk）。
- 在“文件夹”分区头部加入 Toggle("显示文件", isOn: $showFilesInSidebar) 小型开关（checkbox 风格）。
- 关键改动位置：[SidebarView.swift:foldersSection](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/SidebarView.swift#L194-L248)

### 设置页（Settings）
- 在 GeneralSettingsView 增加 Toggle("在侧栏显示文件", isOn: $showFilesInSidebar)。
- 与 SidebarView 使用同一 @AppStorage key 保持全局一致。[SettingsView.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/SettingsView.swift)

## 交互与可用性
- 点击文件节点直接进入单张视图；再次回到网格时保持滚动锚点与选择同步逻辑不变。[ContentView.swift:grid/single 切换](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/ContentView.swift#L378-L401)
- 目录计数逻辑保持：includeSubfolders 开启时显示聚合计数；文件节点不展示计数。
- 左侧开关与设置页开关双向一致；切换后侧栏数据源即时刷新。

## 验证计划
- 使用 UITestDataSeeder 生成测试数据后：
  - 关闭开关：仅显示目录树；
  - 开启开关：目录下展示具体文件；
  - 点击文件：进入 SinglePhotoView；
  - 文件节点的右键菜单操作按预期生效（显示 Finder、移除/删除）。
- 验证 includeSubfolders 与筛选、排序等现有逻辑不受影响。

## 风险与兼容
- 文件节点增加会增大 OutlineGroup 节点数量：对排序与构建已按文件名/目录名做稳定排序。
- 删除/移除单个文件走 Photo 级别操作，避免目录级递归删除逻辑误处理。

## 代码改动清单
- 修改 [ContentView.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/ContentView.swift)：读取 showFilesInSidebar、选择树构建器、实现并注入文件操作回调。
- 修改 [SidebarView.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/SidebarView.swift)：行渲染区分文件/目录、上下文菜单扩展、增加分区头部开关与 @AppStorage。
- 修改 [SettingsView.swift](file:///Users/zhangchao/workspace/dev/Culler/Culler/Culler/Views/SettingsView.swift)：新增“在侧栏显示文件”开关。
